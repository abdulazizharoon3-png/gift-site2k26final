<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New Year Surprise üéÅ</title>
<style>
html, body {
  margin:0; padding:0; overflow:hidden; font-family:Arial,sans-serif;
  height:100%; width:100%; background:#0c0c0c; color:white; text-align:center; position:relative;
}
.screen {
  position:absolute; top:0; left:0; width:100%; height:100%; display:flex;
  flex-direction:column; justify-content:center; align-items:center;
  opacity:0; pointer-events:none; transition: all 0.5s ease; transform:scale(0.95);
}
.active {opacity:1; pointer-events:auto; transform:scale(1);}
button {
  padding:15px 30px; font-size:20px; border:none; border-radius:12px;
  margin-top:20px; cursor:pointer; background: linear-gradient(45deg,#ff3cac,#784ba0,#2b86c5); color:white;
  position: relative;
}
input {
  padding:12px; font-size:18px; border-radius:10px; border:2px solid white; text-align:center; margin-top:20px;
}
#giftIcon, #giftBox {font-size:60px; cursor:pointer; animation:bounce 1s infinite;}
@keyframes bounce {0%,100%{transform:translateY(0);}50%{transform:translateY(-20px);}}
canvas {position:absolute; top:0; left:0; pointer-events:none;}
h2 {padding:0 20px; line-height:1.5em; white-space:pre-wrap;}
</style>
</head>
<body>

<canvas id="canvas"></canvas>

<!-- Start Screen -->
<div id="start" class="screen active">
  <h1 id="startText"></h1>
  <button onclick="goName()">Start</button>
</div>

<!-- Name Input Screen -->
<div id="name" class="screen">
  <h2 id="nameText"></h2>
  <input id="username" placeholder="Your Name">
  <button onclick="checkName()">Next</button>
</div>

<!-- Ariba Pages Container -->
<div id="aribaPages" class="screen"></div>

<!-- Habiba Gift Screen -->
<div id="habibaScreen" class="screen">
  <h2 id="habibaMsg"></h2>
  <div id="habibaGift" style="position:relative;">
    <div id="giftBox">üéÅ</div>
  </div>
  <button id="habibaNextBtn">Next</button>
</div>

<!-- Generic Screens -->
<div id="giftScreen" class="screen"><div id="giftIcon">üéÅ</div></div>
<div id="genericFinal" class="screen">
  <h2 id="finalText"></h2>
</div>

<script>
// --- Canvas setup ---
let canvas = document.getElementById('canvas');
let ctx = canvas.getContext('2d');
canvas.width = window.innerWidth; canvas.height = window.innerHeight;

// Floating hearts
let hearts=[];
for(let i=0;i<20;i++){
  hearts.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, size:Math.random()*15+5, speed:Math.random()*0.5+0.2, opacity:Math.random()*0.4+0.3});
}

// Confetti
let confetti=[];
function Confetti(){
  this.x=Math.random()*canvas.width;
  this.y=Math.random()*canvas.height-50;
  this.vx=(Math.random()-0.5)*2.5;
  this.vy=Math.random()*2+1;
  this.color=`hsl(${Math.random()*360},100%,50%)`;
  this.draw=function(){ctx.fillStyle=this.color; ctx.fillRect(this.x,this.y,5,10); this.x+=this.vx; this.y+=this.vy; if(this.y>canvas.height)this.y=-10;}
}

// Fireworks
let fireworks=[];
function Firework(x,y,color){
  this.x=x; this.y=y; this.particles=[];
  for(let i=0;i<30;i++){
    this.particles.push({x:x,y:y,vx:(Math.random()-0.5)*5,vy:(Math.random()-0.5)*5,alpha:1,color:color});
  }
  this.draw=function(){
    this.particles.forEach(p=>{
      ctx.fillStyle=`rgba(${p.color.r},${p.color.g},${p.color.b},${p.alpha})`;
      ctx.beginPath(); ctx.arc(p.x,p.y,3,0,Math.PI*2); ctx.fill();
      p.x+=p.vx; p.y+=p.vy; p.alpha-=0.03;
    });
    this.particles = this.particles.filter(p=>p.alpha>0);
  }
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  hearts.forEach(h=>{ctx.fillStyle=`rgba(255,0,150,${h.opacity})`; ctx.beginPath(); ctx.arc(h.x,h.y,h.size,0,Math.PI*2); ctx.fill(); h.y-=h.speed; if(h.y<0)h.y=canvas.height;});
  confetti.forEach(c=>c.draw());
  fireworks.forEach(f=>f.draw());
  fireworks = fireworks.filter(f=>f.particles.length>0);
  requestAnimationFrame(animate);
}
animate();

// --- Screens ---
function show(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active');}
function goName(){ show('name'); typeWriter('nameText','Enter Your Name üí´',30); }
typeWriter('startText','üéâ Ready for a Surprise?',30);

// --- Typewriter function ---
function typeWriter(id, text, speed){
  let i=0;
  let elem = document.getElementById(id);
  elem.innerHTML='';
  let interval = setInterval(()=>{
    if(i<text.length){ elem.innerHTML += text.charAt(i); i++; }
    else clearInterval(interval);
  },speed);
}

// --- Name Check ---
function checkName(){
  let name = document.getElementById('username').value.toLowerCase().trim();
  if(name === 'ariba'){ startAribaFlow(); }
  else if(name === 'habiba'){ startHabibaFlow(); }
  else{ show('giftScreen'); }
}

// --- Ariba Flow ---
const aribaMessages=[
  "Didi? üíñ",
  "Is it really u? ü•π",
  "I really love you ‚ù§Ô∏è‚Äçü©π",
  "You‚Äôre the best ü•∞",
  "You kinda understood me like no one ever did üòå",
  "I felt comfortable around you like I never did around anyone else üíñ",
  "The Head Scratch ‚ù§Ô∏è‚Äçü©π",
  "The Tea Spill üíÖ",
  "Aapka vo waala message really made me throw my phone ü•π",
  "‚ù§Ô∏è‚Äçü©π ‚ÄúDidi‚Ä¶ you are unlike anyone I‚Äôve ever met. You see me in ways no one else did, and being around you feels like coming home.‚Äù",
  "I can laugh with you, cry with you, and share thoughts I never dared before. Every moment with you feels safe, comforting, magical, like the world pauses just for us.",
  "Your words, your smile, your care have touched me more deeply than I can express. You are my favorite bari behn, my safe space, my inspiration, my laughter, and my heart.",
  "Every memory we shared is a treasure, and I can‚Äôt wait to make countless more with you. You are truly special, unforgettable, and I absolutely love you ü•π‚ù§Ô∏è‚Äçü©π. This surprise is all for you because no one deserves it more. ‚ù§Ô∏è‚Äçü©πüíñ‚Äù",
  "Happy New Year Didi ‚ù§Ô∏è‚Äçü©π‚ù§Ô∏è‚Äçü©πüéâüéÜ"
];
let currentAriba=0;

function startAribaFlow(){
  let container = document.getElementById('aribaPages');
  container.innerHTML='';
  currentAriba=0;
  show('aribaPages');
  showAribaMessage();
}

function showAribaMessage(){
  let container = document.getElementById('aribaPages');
  container.innerHTML='';
  let h = document.createElement('h2');
  container.appendChild(h);
  typeWriterForElement(h, aribaMessages[currentAriba], 30);

  let btn = document.createElement('button');
  btn.innerText = 'Next';
  btn.onclick = function(){
    currentAriba++;
    if(currentAriba < aribaMessages.length){
      showAribaMessage();
      burstConfetti();
      if(currentAriba>=2) burstFireworks();
    }
  };
  container.appendChild(btn);
  burstConfetti();
  if(currentAriba>=2) burstFireworks();
}

// --- Habiba Flow ---
let habibaPressCount=0;
function startHabibaFlow(){
  show('habibaScreen');
  typeWriter('habibaMsg','What? New Year but it aint Happy for you üíÖ',30);

  let giftBox = document.getElementById('giftBox');
  giftBox.onclick = function(){
    // Pop out emojis and stay
    let emoji1 = document.createElement('span');
    emoji1.innerText='ü´µ';
    emoji1.style.fontSize='50px';
    emoji1.style.position='absolute';
    emoji1.style.left='40%';
    emoji1.style.top='50%';

    let emoji2 = document.createElement('span');
    emoji2.innerText='ü§°';
    emoji2.style.fontSize='50px';
    emoji2.style.position='absolute';
    emoji2.style.left='55%';
    emoji2.style.top='50%';

    let container = document.getElementById('habibaGift');
    container.appendChild(emoji1);
    container.appendChild(emoji2);

    giftBox.style.display='none';
  }

  let nextBtn = document.getElementById('habibaNextBtn');
  nextBtn.onclick = function(){
    habibaPressCount++;
    if(habibaPressCount <=3){
      // Teleport button randomly
      nextBtn.style.top = Math.random()*80+'%';
      nextBtn.style.left = Math.random()*80+'%';
      typeWriter('habibaMsg','wwwhhhaaaaaaaaaaat? Why u still heeeeeeeerreeeee?\nI alr said no Happy New years for you üíÖ',20);
    } else {
      typeWriter('habibaMsg','Alr fine! If u want it that bad tell ayyanu babu to wish it to u Me nai kar raha ü§ß',20);
      nextBtn.style.display='none';
    }
  }
}

// --- Helper typewriter for element ---
function typeWriterForElement(element, text, speed){
  let i=0;
  element.innerHTML='';
  let interval = setInterval(()=>{
    if(i<text.length){ element.innerHTML += text.charAt(i); i++; }
    else clearInterval(interval);
  },speed);
}

// --- Generic Gift Click ---
document.getElementById('giftIcon').onclick=function(){
  let gift=this;
  let top=window.innerHeight/2;
  let flyInterval=setInterval(()=>{
    if(top<-100){ clearInterval(flyInterval); show('genericFinal'); return; }
    top-=10;
    gift.style.transform=`translateY(${top}px) scale(1.2)`;
    burstConfetti();
    if(top%40===0) burstFireworks();
  },50);
}

// --- Particles ---
function burstFireworks(){
  for(let i=0;i<3;i++){
    let color={r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255)};
    fireworks.push(new Firework(Math.random()*canvas.width, Math.random()*canvas.height/2, color));
  }
}
function burstConfetti(){
  for(let i=0;i<20;i++) confetti.push(new Confetti());
}
</script>
</body>
</html>
